from django.contrib.auth import get_user_model
from django.urls import reverse
from rest_framework import status
from rest_framework.test import APITestCase
from rest_framework_simplejwt.tokens import RefreshToken



class ChatGPTAPITests(APITestCase):

    def setUp(self):
        self.user = get_user_model().objects.create_user(first_name="first_name", last_name="last_name",email="email@email.com", password="password")
        self.refresh_token = RefreshToken.for_user(self.user)
        self.access_token = str(self.refresh_token.access_token)

    def test_post_chatgpt(self):
        self.client.credentials(HTTP_AUTHORIZATION=f'Bearer {self.access_token}')
        url = reverse("openai_request")
        data = {
            "prompt" : "[INSTRUCTIONS_START] Write a cover letter using the details provided in the job description and incorporating elements from my resume. Emulate the style and structure of the previous cover letters I have shared. [INSTRUCTIONS_END] [JOB_DESCRIPTION_STARTS] Software Engineer Intern SAAS CooperSurgical · Trumbull, CT · Reposted 5 days ago · Over 100 applicants On-site Matches your job preferences, workplace type is On-site. Full-timeMatches your job preferences, job type is Full-time. Internship  About the job Responsibilities Essential Functions Assist Software Engineering with design, development, and verification of SaaS applications. Perform unit tests, integration tests, document analyze results. Write test plans and reports. Develop software application features, test, and document the design. Perform troubleshooting tasks in simple to complex software applications. Prototype software applications and user interface design. Detect manual steps in current workflow and automate for efficiency in process. Scope The R&D department is looking for Engineering students in Computer Science, or related tracks who are motivated to build and expand their real-world skills in a dynamic product development and manufacturing setting. The R&D interns will assist with the product development of SaaS applications and core engineering processes. Interns will work on relevant in-process engineering projects during their time with the company. Qualifications Knowledge, Skills and Abilities A demonstrated passion for technology and innovative problem solving. A basic understanding of cloud applications architecture and web application design, comfort with at least one programming language, and a desire to learn about new technologies and systems. Ability to recreate, troubleshoot and fault find software defects. Familiarity with C#, .NET, HTML5, CSS3, JavaScript, jQuery, Bootstrap, Vue.js, MS SQL, AWS, or similar technologies. Familiarity with DevOps practices, Git version control, test automation, and continuous integration/continuous deployment (CI/CD) best practices is desired. Professional demeanor. Well organized with attention to detail and ability to carry out tasks independently. Strong communication and interpersonal skills. Experience Either personal software development experience or previous internship experience is desired. Education Current college student, majoring in Computer Science, or related tracks, entering their Junior, or Senior year. Minimum 3.0 GPA. [JOB_DESCRIPTION_ENDS] [RESUME_STARTS] Jacob Bassett Software Developer Mona, UT  | jacobbassett-portfolio.netlify.app Full-stack software developer proficient with JavaScript and Python. Life-long learner passionate about innovations in computer science, biology, and material science to name a few. TECHNICAL SKILLS Languages: Python, JavaScript, R, HTML5, CSS3 Skills and Tools: Github, VS Code, PyCharm, RStudio, React, Django, Zsh, Node.js, Express.js, PROJECTS A-MAZE-ING - Dec 2023 - github.com/.../README.md - demo ● CLI that enables users to create mazes with a variety of maze generation algorithms. ● Leveraging Python to generate mazes, serialize/deserialize data, create maze solutions and generate SVG images. {...} cocktail lover - Aug 2023 - github.com/.../README.md - demo ● Empowers users to discover new cocktail recipes through multiple intuitive search options and curate a collection of their favorites. ● Leveraged JavaScript, React, Github, MongoDB, Node.js, Express.js, and Auth0. ● Envisioned, developed, and resolved all issues autonomously. Systematic mutagenesis of TFIIH subunit p52/Tfb2 identifies residues required for XPB/Ssl2 subunit function and genetic interactions with TFB6 - Oct 2022 – jbc.org/article ● As primary author, I guided this project from its inception to publication. ● Effectively collaborated with distinct labs across the country to enhance the depth and significance of our discoveries. ● Analyzed all data and transformed results into compelling visuals. EDUCATION Code Fellows - Seattle, WA Certificate, Advanced Software Development in Full-Stack Python - Feb 2024 Utah Valley University - Orem, UT Bachelors of Biotechnology, Minor in Chemistry - May 2014 EXPERIENCE Institute for Systems Biology - Seattle, WA - Sept 2014 to Sept 2022 Lab Manager - 2021-2022 ● Managed projects, presented discoveries, facilitated collaborations, managed inventory, adhered to best accounting standards, and participated in hiring. Research Associate III - 2019-2022 ● Developed R and Python programs to automate lab tasks, efficiently analyzed large datasets, and displayed results in a compelling fashion. Research Associate II - 2017-2019 ● Expanded proficiencies to experiment design, protein design, advanced protein purification, antibody production, RNA-seq, mass-spectrometry, and data analysis. Research Associate I - 2014-2017 ● Demonstrated proficiency in core lab techniques such as DNA synthesis, cloning, protein expression, project planning, and process documentation. [RESUME_ENDS] [COVER_LETTER_STARTS] Dear Hiring Manager, I am writing to express my interest in the Software QA Engineer/Test Automation Engineer position at LabCorp. As a recent graduate with experience developing UIs and APIs with a test-driven mindset, I am confident in my ability to contribute effectively to your dynamic team. In my previous roles as a Lab Manager and Research Associate, I managed projects, presented discoveries, and facilitated collaborations on diverse teams. Leveraging my extensive data analysis experience with R, I consistently delivered high-quality results for my own work and the rest of my lab. I have also developed Python programs to automate tasks ranging from file management and text processing to web scraping and robotic sample processing. These experiences have cultivated a meticulous attention to detail and confidence in the face of novel obstacles. I am excited about the opportunity at LabCorp to leverage my technical programming skills, particularly in building performant, tested, and resilient automation software. I look forward to discussing how my skills and experiences align with the goals of LabCorp. Thank you for considering my application. I am eager to contribute to your team and the delivery of enterprise-level solutions.Sincerely, Jacob Bassett[COVER_LETTER_ENDS]",
        }
        headers = {'Authorization': f'Bearer {self.access_token}'}
        response = self.client.post(url, data, format='json', headers=headers)
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        response = response.json()
        self.assertEqual(response.get("success"), True)
        self.assertIn("generated_text",response)


    # def test_post_chatgpt_fail(self):
    #     url = reverse("openai_request")
    #     data = {
    #         "prompt" : "[INSTRUCTIONS_START] Write a cover letter using the details provided in the job description and incorporating elements from my resume. Emulate the style and structure of the previous cover letters I have shared. [INSTRUCTIONS_END] [JOB_DESCRIPTION_STARTS] Software Engineer Intern SAAS CooperSurgical · Trumbull, CT · Reposted 5 days ago · Over 100 applicants On-site Matches your job preferences, workplace type is On-site. Full-timeMatches your job preferences, job type is Full-time. Internship  About the job Responsibilities Essential Functions Assist Software Engineering with design, development, and verification of SaaS applications. Perform unit tests, integration tests, document analyze results. Write test plans and reports. Develop software application features, test, and document the design. Perform troubleshooting tasks in simple to complex software applications. Prototype software applications and user interface design. Detect manual steps in current workflow and automate for efficiency in process. Scope The R&D department is looking for Engineering students in Computer Science, or related tracks who are motivated to build and expand their real-world skills in a dynamic product development and manufacturing setting. The R&D interns will assist with the product development of SaaS applications and core engineering processes. Interns will work on relevant in-process engineering projects during their time with the company. Qualifications Knowledge, Skills and Abilities A demonstrated passion for technology and innovative problem solving. A basic understanding of cloud applications architecture and web application design, comfort with at least one programming language, and a desire to learn about new technologies and systems. Ability to recreate, troubleshoot and fault find software defects. Familiarity with C#, .NET, HTML5, CSS3, JavaScript, jQuery, Bootstrap, Vue.js, MS SQL, AWS, or similar technologies. Familiarity with DevOps practices, Git version control, test automation, and continuous integration/continuous deployment (CI/CD) best practices is desired. Professional demeanor. Well organized with attention to detail and ability to carry out tasks independently. Strong communication and interpersonal skills. Experience Either personal software development experience or previous internship experience is desired. Education Current college student, majoring in Computer Science, or related tracks, entering their Junior, or Senior year. Minimum 3.0 GPA. [JOB_DESCRIPTION_ENDS] [RESUME_STARTS] Jacob Bassett Software Developer Mona, UT  | jacobbassett-portfolio.netlify.app Full-stack software developer proficient with JavaScript and Python. Life-long learner passionate about innovations in computer science, biology, and material science to name a few. TECHNICAL SKILLS Languages: Python, JavaScript, R, HTML5, CSS3 Skills and Tools: Github, VS Code, PyCharm, RStudio, React, Django, Zsh, Node.js, Express.js, PROJECTS A-MAZE-ING - Dec 2023 - github.com/.../README.md - demo ● CLI that enables users to create mazes with a variety of maze generation algorithms. ● Leveraging Python to generate mazes, serialize/deserialize data, create maze solutions and generate SVG images. {...} cocktail lover - Aug 2023 - github.com/.../README.md - demo ● Empowers users to discover new cocktail recipes through multiple intuitive search options and curate a collection of their favorites. ● Leveraged JavaScript, React, Github, MongoDB, Node.js, Express.js, and Auth0. ● Envisioned, developed, and resolved all issues autonomously. Systematic mutagenesis of TFIIH subunit p52/Tfb2 identifies residues required for XPB/Ssl2 subunit function and genetic interactions with TFB6 - Oct 2022 – jbc.org/article ● As primary author, I guided this project from its inception to publication. ● Effectively collaborated with distinct labs across the country to enhance the depth and significance of our discoveries. ● Analyzed all data and transformed results into compelling visuals. EDUCATION Code Fellows - Seattle, WA Certificate, Advanced Software Development in Full-Stack Python - Feb 2024 Utah Valley University - Orem, UT Bachelors of Biotechnology, Minor in Chemistry - May 2014 EXPERIENCE Institute for Systems Biology - Seattle, WA - Sept 2014 to Sept 2022 Lab Manager - 2021-2022 ● Managed projects, presented discoveries, facilitated collaborations, managed inventory, adhered to best accounting standards, and participated in hiring. Research Associate III - 2019-2022 ● Developed R and Python programs to automate lab tasks, efficiently analyzed large datasets, and displayed results in a compelling fashion. Research Associate II - 2017-2019 ● Expanded proficiencies to experiment design, protein design, advanced protein purification, antibody production, RNA-seq, mass-spectrometry, and data analysis. Research Associate I - 2014-2017 ● Demonstrated proficiency in core lab techniques such as DNA synthesis, cloning, protein expression, project planning, and process documentation. [RESUME_ENDS] [COVER_LETTER_STARTS] Dear Hiring Manager, I am writing to express my interest in the Software QA Engineer/Test Automation Engineer position at LabCorp. As a recent graduate with experience developing UIs and APIs with a test-driven mindset, I am confident in my ability to contribute effectively to your dynamic team. In my previous roles as a Lab Manager and Research Associate, I managed projects, presented discoveries, and facilitated collaborations on diverse teams. Leveraging my extensive data analysis experience with R, I consistently delivered high-quality results for my own work and the rest of my lab. I have also developed Python programs to automate tasks ranging from file management and text processing to web scraping and robotic sample processing. These experiences have cultivated a meticulous attention to detail and confidence in the face of novel obstacles. I am excited about the opportunity at LabCorp to leverage my technical programming skills, particularly in building performant, tested, and resilient automation software. I look forward to discussing how my skills and experiences align with the goals of LabCorp. Thank you for considering my application. I am eager to contribute to your team and the delivery of enterprise-level solutions.Sincerely, Jacob Bassett[COVER_LETTER_ENDS]",
    #     }
    #     headers = {'Authorization': f'Bearer {self.access_token+"33"}'}
    #     print("access_token",self.access_token+"33")
    #     response = self.client.post(url, data, format='json', headers=headers)
    #     self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)




